@startuml Database Schema for AprendaAI

' Entidades principais
entity "User" as user {
  * id : int <<PK>>
  --
  * name : string
  * email : string
  * password : string
  * role : enum [student, teacher, admin]
  * created_at : timestamp
  * updated_at : timestamp
}

entity "Subject" as subject {
  * id : int <<PK>>
  --
  * name : string
  * description : text
  * created_at : timestamp
  * updated_at : timestamp
}

entity "Topic" as topic {
  * id : int <<PK>>
  --
  * subject_id : int <<FK>>
  * name : string
  * description : text
  * created_at : timestamp
  * updated_at : timestamp
}

entity "Question" as question {
  * id : int <<PK>>
  --
  * topic_id : int <<FK>>
  * exam_id : int <<FK>>
  * content : text
  * difficulty : enum [easy, medium, hard]
  * type : enum [multiple_choice, true_false, essay]
  * created_at : timestamp
  * updated_at : timestamp
}

entity "Answer" as option {
  * id : int <<PK>>
  --
  * question_id : int <<FK>>
  * content : text
  * answers : json
  * created_at : timestamp
  * updated_at : timestamp
}

entity "Exam" as exam {
  * id : int <<PK>>
  --
  * name : string
  * description : text
  * year : int
  * institution : string
  * created_at : timestamp
  * updated_at : timestamp
}

entity "UserProgress" as progress {
  * id : int <<PK>>
  --
  * user_id : int <<FK>>
  * topic_id : int <<FK>>
  * proficiency_level : float
  * last_interaction : timestamp
  * created_at : timestamp
  * updated_at : timestamp
}

entity "UserAnswer" as answer {
  * id : int <<PK>>
  --
  * user_id : int <<FK>>
  * question_id : int <<FK>>
  * selected_option_id : int <<FK>>
  * is_correct : boolean
  * answer_time : int
  * created_at : timestamp
  * updated_at : timestamp
}

entity "StudyPlan" as plan {
  * id : int <<PK>>
  --
  * user_id : int <<FK>>
  * name : string
  * description : text
  * start_date : date
  * end_date : date
  * created_at : timestamp
  * updated_at : timestamp
}

entity "StudySession" as session {
  * id : int <<PK>>
  --
  * study_plan_id : int <<FK>>
  * topic_id : int <<FK>>
  * duration : int
  * scheduled_date : date
  * status : enum [pending, completed, skipped]
  * created_at : timestamp
  * updated_at : timestamp
}

' Removido modelo ExamQuestion, pois cada questão pertence a um único exame

' Relacionamentos
user ||--o{ progress : "tem"
user ||--o{ answer : "responde"
user ||--o{ plan : "possui"

subject ||--o{ topic : "contém"

topic ||--o{ question : "contém"
topic ||--o{ session : "possui"
topic ||--o{ progress : "relacionado a"

question ||--o{ option : "tem"
question ||--o{ answer : "respondida por"
question }|--|| exam : "pertence a"

plan ||--o{ session : "contém"

exam ||--o{ question : "contém"

@enduml
